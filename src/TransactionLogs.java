import java.util.*;

public class TransactionLogs {
    public static List<String> processLogs(List<String> logs, int threshold) {
        Set<String> thresholdList=new TreeSet();
        HashMap<String,Integer> thresholdMap=new HashMap();
        for(String s:logs){
           String transaction[]= s.split(" ");
           if(transaction[0].equals(transaction[1])){
               thresholdMap.put(transaction[0],thresholdMap.getOrDefault(transaction[0],0)+1);
               if(thresholdMap.get(transaction[0])>=threshold)
                   thresholdList.add(transaction[0]);
           }else{
               thresholdMap.put(transaction[0],thresholdMap.getOrDefault(transaction[0],0)+1);
               if(thresholdMap.get(transaction[0])>=threshold)
                   thresholdList.add(transaction[0]);
               thresholdMap.put(transaction[1],thresholdMap.getOrDefault(transaction[1],0)+1);
               if(thresholdMap.get(transaction[1])>=threshold)
                   thresholdList.add(transaction[1]);
           }

        }
        return new ArrayList<>(thresholdList);
    }

    public static void main(String[] args) {
        String [] arr={
            "45 250 100207521",
                    "859 410 138292978",
                    "347 981 299907382",
                    "349 443 569994681",
                    "480 539 393068675",
                "111 633 959592679",};

//            796 106 519292985
//            225 663 969645306
//            611 480 547493991
//            257 934 460909387
//            726 910 176436794
//            611 539 90222150
//            721 644 355219115
//            208 291 812593589
//            829 589 433836044
//            721 913 265170387
//            5 507 679281893
//            139 491 143468668
//            280 103 214453228
//            281 919 718772959
//            677 705 100163300
//            208 644 883227314
//            789 986 994070087
//            503 256 957684739
//            804 75 911877874
//            694 913 249182058
//            955 697 280946509
//            225 380 36644058
//            955 257 480889464
//            380 122 675739155
//            934 443 702708557
//            526 981 677938413
//            559 721 756972618
//            253 635 23438228
//            498 272 558801340
//            484 708 285217269
//            592 542 616746292
//            972 752 243153049
//            291 290 896567589
//            100 257 13994438
//            203 203 398401902
//            616 526 947520652
//            255 949 363721190
//            747 567 235238445
//            257 291 119398237
//            598 467 78212806
//            146 839 645388564
//            677 288 979721785
//            247 290 74096683
//            677 203 265292194
//            288 326 537377979
//            139 697 152334001
//            465 357 319158839
//            843 135 462557707
//            319 219 384583052
//            347 203 28081306
//            191 410 725949242
//            727 408 901862513
//            12 221 808026134
//            366 484 901781155
//            965 981 632434286
//            275 899 213187466
//            705 298 288971142
//            863 433 85423496
//            721 380 951304384
//            306 369 848722541
//            635 488 268307275
//            797 160 600220740
//            378 479 627679833
//            677 273 998140214
//            644 694 860066981
//            288 705 557660249
//            781 875 973360008
//            587 326 102762025
//            314 443 748403891
//            616 225 393656995
//            443 443 439704976
//            225 644 640849668
//            512 709 23485303
//            218 765 895949038
//            341 193 40274892
//            772 556 729311605
//            288 298 508225089
//            210 65 259908704
//            243 245 229355727
//            559 559 259316740
//            810 117 232616633
//            166 617 472232915
//            913 526 296787512
//            111 563 192850760
//            380 290 700368536
//            443 981 508362925
//            616 587 23187140
//            290 819 666227500
//            899 146 676361243
//            611 290 128239687
//            359 555 303260192
//            105 651 770932148
//            122 174 819526769
//            680 826 917657401
//            50 184 428380132
//            326 138 487740116
//            139 587 666220642
//            182 495 194060454
//            559 314 608962152
//            772 694 77398080
//            632 240 103247383
//            203 298 288939792
//            644 314 373664661
//            715 225 47142251
//            76 491 935739534
//            677 625 794725391
//            257 973 54580774
//            746 690 246244865
//            347 705 679503146
//            438 600 769816077
//            913 208 330317292
//            175 782 943675555
//            611 380 401419300
//            776 163 129619242
//            2 357 798770659
//            841 547 121955524
//            542 657 767052209
//            225 559 538837568
//            955 697 35804917
//            526 913 78604963
//            211 886 165508317
//            349 318 348143501
//            298 510 74859537
//            794 162 588198505
//            663 225 205329321
//            539 644 227580531
//            193 174 730132060
//            878 739 924465081
//            493 128 408900348
//            122 443 569503342
//            721 443 841670153
//            611 288 365218268
//            595 293 511886184
//            380 526 884736238
//            173 516 626963941
//            228 360 783433010
//            118 360 846410923
//            355 380 701314527
//            208 318 15408748
//            343 139 403928449
//            795 66 390852419
//            208 715 351813402
//            476 470 183693968
//            663 913 698912454
//            548 875 971953106
//            455 346 670087940
//            6 246 367524824
//            211 992 233506611
//            941 85 951111058
//            812 759 424232949
//            913 247 752409228
//            524 366 60621302
//            298 314 634745227
//            456 397 612479942
//            934 343 522209242
//            126 602 81276943
//            776 432 46595101
//            35 113 750120232
//            314 291 732517878
//            349 955 986927040
//            677 274 492711863
//            290 349 984479070
//            610 52 215676950
//            288 291 616622100
//            66 883 65837605
//            355 247 640445398
//            108 99 435171844
//            448 362 245393544
//            913 805 171508169
//            448 134 676895474
//            694 174 800218675
//            358 90 613442709
//            934 80 794700431
//            627 132 257329664
//            325 168 276100044
//            247 611 103346442
//            380 274 690328878
//            715 139 851527945
//            422 856 852776583
//            606 136 911660130
//            819 290 56772295
//            924 391 546336699
//            35 478 841677481
//            122 694 132968306
//            380 705 651780606
//            481 734 855246084
//            668 724 717743210
//            600 183 16378228
//            981 526 365966707
//            559 355 381381127
//            959 530 291886891
//            961 517 265321557
//            97 244 876633024
//            837 906 804706141
//            347 355 537218142
//            434 567 774910531
//            290 715 403522523
//            981 314 916846127
//            611 819 768802809
//            977 80 821805805
//            774 517 948884863
//            955 539 511295077
//            318 203 614911424
//            702 339 710984429
//            694 644 817029441
//            343 697 44536638
//            418 373 868397315
//            813 868 188741586
//            545 279 575912565
//            539 314 646499484
//            57 13 550339433
//            955 819 688961231
//            721 663 918978038
//            697 934 87520898
//            563 688 276574947
//            518 531 508518852
//            864 22 215442252
//            731 9 746056555
//            723 569 886658250
//            644 208 688997530
//            705 587 853021519
//            443 122 683671735
//            945 262 613739625
//            357 36 461154319
//            819 343 161649970
//            662 613 276622589
//            913 288 6076985
//            443 721 610033058
//            380 955 438914282
//            225 291 103783098
//            342 826 120202130
//            288 705 205121682
//            758 547 36353961
//            349 347 5022105
//            150 392 474582898
//            611 326 320638242
//            539 380 377807616
//            819 805 830871857
//            121 435 425878205
//            203 913 115545769
//            298 195 458514312
//            743 468 937162926
//            995 426 567342505
//            913 291 895412602
//            355 772 826208294
//            139 138 857575423
//            955 705 994263216
//            174 715 976743620
//            845 262 553990658
//            973 138 990189437
//            526 298 764272272
//            616 291 942955632
//            485 348 85147342
//            970 607 895677174
//            299 484 950037607
//            355 203 65162708
//            973 973 790252211
//            689 366 675070753
//            559 174 326010985
//            539 174 838598710
//            765 743 733150953
//            349 347 785756357
//            863 343 84401466
//            559 526 773963402
//            616 480 843265786
//            526 343 461470935
//            587 347 757454249
//            372 838 353889360
//            757 438 849507574
//            350 419 82463537
//            347 298 924596810
//            288 326 262317730
//            343 721 200422062
//            675 874 407613687
//            257 694 245964870
//            803 347 957551750
//            322 664 825104879
//            770 251 526287815
//            274 139 542209272
//            443 913 367942727
//            462 245 765414104
//            679 872 331241083
//            721 298 666937004
//            290 772 125540511
//            157 943 156775521
//            225 203 778619743
//            490 207 551108346
//            955 139 97478520
//            883 16 320873029
//            310 379 366425151
//            274 298 821364567
//            625 287 82510167
//            349 274 934341291
//            905 244 143482822
//            616 257 362673420
//            90 717 926301552
//            961 374 941923214
//            314 559 131290210
//            208 343 504981140
//            138 343 493407301
//            772 208 72002021
//            921 787 102893300
//            973 99 666693752
//            539 291 116341965
//            135 149 464827262
//            526 741 560355185
//            208 174 106187223
//            545 358 131075855
//            347 174 4685986
//            225 257 866359077
//            151 34 716245897
//            959 386 717247634
//            355 772 79690316
//            257 355 425625427
//            291 225 494718977
//            73 350 999521810
//            162 965 364210396
//            526 298 673158220
//            274 208 980712375
//            814 377 800850752
//            225 355 507406812
//            846 875 916893128
//            46 442 842649764
//            443 705 551216392
//            668 966 922091828
//            193 934 798030641
//            814 923 635390613
//            420 838 109970272
//            665 710 187242066
//            721 705 201022564
//            792 148 816339758
//            122 139 77252137
//            122 291 117845877
//            429 799 928390148
//            961 216 840904990
//            274 677 20110627
//            139 343 334074031
//            349 526 83550511
//            316 277 624113681
//            955 248 640504641
//            805 981 352030893
//            526 343 997498166
//            611 193 727557085
//            146 856 183176991
//            343 257 266668515
//            138 174 996639302
//            526 343 990982827
//            973 274 203388760
//            329 124 997251072
//            288 772 143656090
//            274 257 181524685
//            138 288 820896806
//            84 858 716456264
//            349 805 702782861
//            729 229 771599972
//            819 697 915890007
//            528 397 252914452
//            981 526 147911950
//            225 934 323334361
//            274 644 830380094
//            981 326 748253189
//            939 425 4079836
//            539 772 707055381
//            235 484 7265526
//            218 78 322289313
//            370 187 983338303
//            402 39 681575123
//            809 217 719715242
//            518 809 13554601
//            766 228 13690780
//            523 228 272541646
//            193 347 31033639
//            774 489 332370070
//            443 288 957961893
//            951 729 738034581
//            799 538 906152285
//            358 767 458409736
//            174 174 696442574
//            208 203 66576702
//            611 138 833844882
//            105 683 963701178
//            23 5 934300746
//            808 641 358099006
//            936 670 527451739
//            335 736 712373303
//            139 396 372254417
//            208 697 7856813
//            598 493 291173211
//            861 774 870338530
//            559 380 85061684
//            43 74 35839234
//            431 366 559215052
//            934 298 687382229
//            848 142 152364545
//            197 194 208281939
//            138 973 131035552
//            71 256 649147133
//            291 955 717572150
//            194 756 400802918
//            45 609 893498755
//            138 663 873942339
//            520 483 405688165
//            651 692 7369506
//            214 285 482855720
//            63 174 394351902
//            871 577 26226439
//            54 831 45445609
//            290 274 99826465
//            644 802 675362363
//            416 866 438536548
//            254 884 475211572
//            450 80 265677800
//            347 644 35345050
//            955 259 841765802
//            290 174 261117958
//            526 559 814873286
//            122 298 417431722
//            239 437 30585619
//            574 634 560813563
//            819 819 995662150
//            490 942 327332287
//            231 338 576174609
//            347 559 863821722
//            187 280 81461590
//            314 480 181248228
//            986 791 234973592
//            203 772 175721422
//            343 291 14425540
//            581 230 173012840
//            347 663 619717543
//            231 351 664087535
//            641 806 362317093
//            826 102 53326605
//            899 240 901296073
//            174 526 960266905
//            987 353 538209487
//            138 955 852390038
//            365 630 360221399
//            314 981 260968456
//            616 546 841920910
//            149 303 906561159
//            193 715 208017491
//            414 496 128475581
//            980 383 72400230
//            644 715 304639160
//            576 218 961474545
//            749 604 807422635
//            274 663 166098242
//            708 1 434367256
//            294 915 989675762
//            343 318 974007340
//            450 450 81313498
//            326 805 36208988
//            109 980 930990208
//            913 913 138367094
//            955 663 619531891
//            973 955 848789571
//            424 12 828041292
//            677 318 517105946
//            371 171 165183977
//            775 163 40321246
//            792 716 742525966
//            203 819 984415024
//            434 498 631375014
//            516 104 50273938
//            955 724 409302052
//            174 480 280164036
//            257 805 169727539
//            174 611 361515739
//            935 823 324100651
//            208 715 393095990
//            574 391 653202605
//            582 486 456226012
//            566 653 601916141
//            347 257 59730132
//            480 526 196499242
//            610 803 478662871
//            798 21 153818027
//            347 559 131301724
//            443 247 625638574
//            380 970 987873131
//            560 213 109175001
//            291 913 192769462
//            199 534 924912859
//            806 420 6439380
//            193 298 414701270
//            291 257 137705481
//            913 138 982100818
//            355 694 789858266
//            225 347 488325580
//            298 934 330443238
//            609 135 11672640
//            257 721 228769562
//            981 981 584787419
//            138 139 970648214
//            56 733 263627642
//            850 542 668850525
//            288 318 556853132
//            203 480 680109257
//            948 407 312736913
//            509 271 642038932
//            819 347 779500783
//            981 349 919267681
//            323 21 453375348
//            697 913 442318295
//            132 555 65258788
//            542 680 258364985
//            122 539 759302349
//            143 349 546281042
//            247 539 869767495
//            539 314 347472211
//            14 878 161599530
//            16 890 142683416
//            913 298 415859109
//            367 126 465881494
//            596 581 346389353
//            689 891 63363754
//            677 611 223341498
//            697 955 850822580
//            247 355 790692512
//            17 708 435840984
//            539 193 291120286
//            480 347 247305160
//            526 644 876746255
//            805 203 580173034
//            380 443 289963983
//            174 206 46579113
//            676 561 801664314
//            571 15 818763297
//            817 297 532768701
//            138 203 956947045
//            805 663 688194661
//            776 96 916297214
//            266 263 683568936
//            941 268 363059815
//            734 530 505539030
//            246 535 380860940
//            58 723 417927213
//            973 677 706819294
//            677 934 508218329
//            693 575 103530186
//            901 752 299383345
//            247 694 786358177
//            526 380 821934015
//            347 298 520146661
//            819 225 643956476
//            962 174 7984363
//            291 443 968541701
//            473 576 951639007
//            341 277 267528584
//            784 239 725377720
//            36 926 950627977
//            587 526 846479986
//            663 208 747480710
//            480 138 844581701
//            291 934 441878243
//            966 186 139461947
//            462 104 910817368
//            312 874 384158238
//            934 257 724318187
//            616 208 138394621
//            877 666 875146861
//            805 981 948634601
//            225 288 284322731
//            420 558 273938344
//            705 955 835320581
//            93 58 685548524
//            166 862 509999464
//            970 782 912058438
//            715 913 505991789
//            754 211 66262}

        List<String> list=Arrays.asList(arr);
        List<String> list1=processLogs(list,3);
        for(String s:list1){
            System.out.print(s+" ");
        }
    }
}
